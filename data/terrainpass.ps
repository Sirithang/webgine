precision mediump float;

varying vec4 oWorldPos;
varying vec3 oNormal;

uniform vec3 uColor;

uniform vec4 uLightDir;
uniform vec4 uSkyColor;
uniform vec4 uGroundColor;

void main()                                  
{                      
	//under 0 go toward "beach"
	float worldH = clamp(-(oWorldPos.y / oWorldPos.w - 1.0), 0.0, 1.0);
   
   //steeper slope give rocky

   float sampling = (dot(oNormal,vec3(0,1,0)) + 1.0) * 0.5;
   
   float intensity = clamp(dot(oNormal, -uLightDir.xyz), 0.0,1.0);  
   
   vec3 sand = vec3(0.96, 0.87, 0.42);
   vec3 grass = vec3(0.5, 1.0, 0.6);
   vec3 rock = vec3(0.56,0.53,0.49);

   vec3 col = mix(grass, sand, worldH);

   vec4 lightCol = mix(uGroundColor, uSkyColor, sampling);
                    
   gl_FragColor = vec4 ( col * intensity, 1.0 ) * lightCol;
}           